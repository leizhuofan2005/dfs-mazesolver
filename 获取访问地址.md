# è·å– Web åº”ç”¨è®¿é—®åœ°å€

## âœ… å·²å®Œæˆ

1. âœ… kubectl å·²å®‰è£…
2. âœ… éƒ¨ç½²é…ç½®æ–‡ä»¶å·²å‡†å¤‡ï¼š`ack-deployment.yaml`
3. âœ… é•œåƒåœ°å€ï¼š`registry.cn-hangzhou.aliyuncs.com/algorithm-games/algorithm-games:latest`

## ğŸš€ å¿«é€Ÿéƒ¨ç½²ï¼ˆ3 æ­¥è·å–è®¿é—®åœ°å€ï¼‰

### æ­¥éª¤ 1: ç¡®ä¿é•œåƒå·²æ„å»º

åœ¨ ACR æ§åˆ¶å°æ£€æŸ¥é•œåƒæ˜¯å¦å·²æ„å»ºï¼š
- ç™»å½•ï¼šhttps://cr.console.aliyun.com
- æ£€æŸ¥å‘½åç©ºé—´ `algorithm-games` ä¸‹çš„é•œåƒä»“åº“ `algorithm-games`
- å¦‚æœé•œåƒæœªæ„å»ºï¼Œè¯·ï¼š
  1. é…ç½®æ„å»ºè§„åˆ™ï¼ˆDockerfile è·¯å¾„ï¼š`./Dockerfile`ï¼‰
  2. è§¦å‘æ„å»º
  3. ç­‰å¾…æ„å»ºå®Œæˆï¼ˆçº¦ 5-10 åˆ†é’Ÿï¼‰

### æ­¥éª¤ 2: é…ç½® kubectl è¿æ¥åˆ° ACK

**æ–¹å¼ A - é€šè¿‡æ§åˆ¶å°ï¼ˆæ¨èï¼‰ï¼š**
1. ç™»å½•ï¼šhttps://cs.console.aliyun.com
2. é€‰æ‹©ä½ çš„ ACK é›†ç¾¤
3. ç‚¹å‡» **è¿æ¥ä¿¡æ¯** æˆ– **é›†ç¾¤ä¿¡æ¯**
4. å¤åˆ¶ kubeconfig å†…å®¹
5. ä¿å­˜åˆ°æ–‡ä»¶ï¼š`kubeconfig.yaml`
6. è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
   ```powershell
   $env:KUBECONFIG = "kubeconfig.yaml"
   kubectl get nodes  # æµ‹è¯•è¿æ¥
   ```

**æ–¹å¼ B - é€šè¿‡é˜¿é‡Œäº‘ CLIï¼š**
```powershell
# å®‰è£…é˜¿é‡Œäº‘ CLIï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
npm install -g @alicloud/cli

# é…ç½® AccessKey
aliyun configure set --profile default --mode AK --region cn-hangzhou --access-key-id LTAI5tFDDZiMKb29RrdPSU3h --access-key-secret Q0TbTjlio3msQKMDqcTPTQNTOE2oac

# è·å– kubeconfigï¼ˆæ›¿æ¢ YOUR_CLUSTER_ID ä¸ºä½ çš„é›†ç¾¤ IDï¼‰
aliyun cs GET /k8s/YOUR_CLUSTER_ID/user_config | Out-File -Encoding utf8 kubeconfig.yaml
$env:KUBECONFIG = "kubeconfig.yaml"
```

### æ­¥éª¤ 3: éƒ¨ç½²å¹¶è·å–è®¿é—®åœ°å€

è¿è¡Œè‡ªåŠ¨åŒ–è„šæœ¬ï¼š
```powershell
.\deploy-and-get-url.ps1
```

æˆ–æ‰‹åŠ¨æ‰§è¡Œï¼š
```powershell
# åº”ç”¨éƒ¨ç½²é…ç½®
kubectl apply -f ack-deployment.yaml

# ç­‰å¾… Pod å¯åŠ¨ï¼ˆçº¦ 30 ç§’ï¼‰
Start-Sleep -Seconds 30

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
kubectl get svc algorithm-games-service -n default

# è·å–å¤–éƒ¨ IP
$svc = kubectl get svc algorithm-games-service -n default -o json | ConvertFrom-Json
$externalIP = $svc.status.loadBalancer.ingress[0].ip
if (-not $externalIP) {
    $externalIP = $svc.status.loadBalancer.ingress[0].hostname
}
Write-Host "è®¿é—®åœ°å€: http://$externalIP"
```

## ğŸ“‹ å¦‚æœè¿˜æ²¡æœ‰ ACK é›†ç¾¤

### åˆ›å»º ACK é›†ç¾¤

1. ç™»å½•ï¼šhttps://cs.console.aliyun.com
2. ç‚¹å‡» **åˆ›å»ºé›†ç¾¤**
3. é€‰æ‹© **æ ‡å‡†æ‰˜ç®¡é›†ç¾¤**
4. é…ç½®ï¼š
   - é›†ç¾¤åç§°ï¼š`algorithm-games-cluster`
   - åœ°åŸŸï¼š`åä¸œ1ï¼ˆæ­å·ï¼‰`
   - Kubernetes ç‰ˆæœ¬ï¼šæœ€æ–°ç¨³å®šç‰ˆ
   - èŠ‚ç‚¹é…ç½®ï¼šæœ€å°é…ç½®å³å¯ï¼ˆæµ‹è¯•ç”¨ï¼‰
5. ç‚¹å‡» **åˆ›å»ºé›†ç¾¤**
6. ç­‰å¾…é›†ç¾¤åˆ›å»ºå®Œæˆï¼ˆçº¦ 5-10 åˆ†é’Ÿï¼‰

### æˆ–è€…ä½¿ç”¨æ§åˆ¶å°ç›´æ¥éƒ¨ç½²

å¦‚æœä¸æƒ³ä½¿ç”¨ kubectlï¼Œå¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°éƒ¨ç½²ï¼š

1. ç™»å½•ï¼šhttps://cs.console.aliyun.com
2. é€‰æ‹©é›†ç¾¤ â†’ **å·¥ä½œè´Ÿè½½** â†’ **æ— çŠ¶æ€**
3. ç‚¹å‡» **ä½¿ç”¨é•œåƒåˆ›å»º**
4. é…ç½®ï¼š
   - **åº”ç”¨åç§°**ï¼š`algorithm-games`
   - **é•œåƒ**ï¼š`registry.cn-hangzhou.aliyuncs.com/algorithm-games/algorithm-games:latest`
   - **ç«¯å£**ï¼š`8000`
   - **ç¯å¢ƒå˜é‡**ï¼š
     - `ALLOWED_ORIGINS=*`
     - `PORT=8000`
5. ç‚¹å‡» **åˆ›å»º**
6. ç­‰å¾…éƒ¨ç½²å®Œæˆ
7. åœ¨ **æœåŠ¡** é¡µé¢æŸ¥çœ‹å¤–éƒ¨è®¿é—®åœ°å€

## ğŸ” æ£€æŸ¥éƒ¨ç½²çŠ¶æ€

```powershell
# æŸ¥çœ‹ Pod çŠ¶æ€
kubectl get pods -n default -l app=algorithm-games

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
kubectl get svc algorithm-games-service -n default

# æŸ¥çœ‹ Pod æ—¥å¿—
kubectl logs -n default -l app=algorithm-games

# æŸ¥çœ‹äº‹ä»¶
kubectl get events -n default --sort-by='.lastTimestamp'
```

## ğŸŒ è·å–è®¿é—®åœ°å€

LoadBalancer ç±»å‹æœåŠ¡ä¼šè‡ªåŠ¨åˆ†é…å¤–éƒ¨ IPï¼Œé€šå¸¸éœ€è¦ 1-2 åˆ†é’Ÿã€‚

```powershell
# æ–¹æ³• 1: ç›´æ¥æŸ¥çœ‹
kubectl get svc algorithm-games-service -n default

# æ–¹æ³• 2: è·å– IP åœ°å€
kubectl get svc algorithm-games-service -n default -o jsonpath='{.status.loadBalancer.ingress[0].ip}'

# æ–¹æ³• 3: å®Œæ•´ä¿¡æ¯
kubectl get svc algorithm-games-service -n default -o wide
```

è®¿é—®åœ°å€æ ¼å¼ï¼š`http://ä½ çš„å¤–éƒ¨IP`

## ğŸ†˜ å¸¸è§é—®é¢˜

### é•œåƒæ‹‰å–å¤±è´¥
- æ£€æŸ¥é•œåƒæ˜¯å¦å·²æ„å»ºå®Œæˆ
- æ£€æŸ¥ ACR ç™»å½•å‡­è¯æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹ Pod æ—¥å¿—ï¼š`kubectl logs -n default -l app=algorithm-games`

### æœåŠ¡æ²¡æœ‰å¤–éƒ¨ IP
- ç­‰å¾… 1-2 åˆ†é’Ÿè®©é˜¿é‡Œäº‘åˆ†é… IP
- æ£€æŸ¥æœåŠ¡ç±»å‹æ˜¯å¦ä¸º LoadBalancer
- åœ¨ ACK æ§åˆ¶å°æŸ¥çœ‹æœåŠ¡çŠ¶æ€

### Pod ä¸€ç›´å¤„äº Pending çŠ¶æ€
- æ£€æŸ¥èŠ‚ç‚¹èµ„æºæ˜¯å¦å……è¶³
- æŸ¥çœ‹ Pod äº‹ä»¶ï¼š`kubectl describe pod -n default -l app=algorithm-games`

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤æ”¶é›†ä¿¡æ¯ï¼š

```powershell
# æ”¶é›†è¯Šæ–­ä¿¡æ¯
kubectl version --client
kubectl get nodes
kubectl get pods -n default
kubectl get svc -n default
kubectl describe pod -n default -l app=algorithm-games
kubectl logs -n default -l app=algorithm-games
```


