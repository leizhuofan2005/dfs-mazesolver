# å®Œæ•´è‡ªåŠ¨åŒ–éƒ¨ç½²æŒ‡å—

## ğŸ¯ ç›®æ ‡
å®Œæˆæ‰€æœ‰éƒ¨ç½²æ­¥éª¤å¹¶è·å–å¯ç›´æ¥è®¿é—®çš„ Web åº”ç”¨åœ°å€ã€‚

## ğŸ“‹ å‰ç½®æ¡ä»¶æ£€æŸ¥

### 1. ACR å‘½åç©ºé—´å’Œé•œåƒä»“åº“
- âœ… å‘½åç©ºé—´ï¼š`algorithm-games`
- âœ… é•œåƒä»“åº“ï¼š`algorithm-games`
- âœ… é•œåƒå·²æ„å»ºï¼š`registry.cn-hangzhou.aliyuncs.com/algorithm-games/algorithm-games:latest`

### 2. ACK é›†ç¾¤
- âœ… å·²åˆ›å»º ACK é›†ç¾¤
- âœ… é›†ç¾¤çŠ¶æ€æ­£å¸¸

### 3. æœ¬åœ°å·¥å…·
- â³ kubectlï¼ˆæ­£åœ¨å®‰è£…ï¼‰
- â³ kubeconfig é…ç½®

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: å®‰è£… kubectlï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰

```powershell
winget install --id Kubernetes.kubectl
```

### æ­¥éª¤ 2: è·å– ACK é›†ç¾¤çš„ kubeconfig

**æ–¹å¼ A - é€šè¿‡æ§åˆ¶å°ï¼š**
1. ç™»å½•ï¼šhttps://cs.console.aliyun.com
2. é€‰æ‹©ä½ çš„é›†ç¾¤
3. ç‚¹å‡» **è¿æ¥ä¿¡æ¯**
4. å¤åˆ¶ kubeconfig å†…å®¹
5. ä¿å­˜åˆ°æ–‡ä»¶ï¼š`kubeconfig.yaml`

**æ–¹å¼ B - é€šè¿‡é˜¿é‡Œäº‘ CLIï¼š**
```powershell
# å®‰è£…é˜¿é‡Œäº‘ CLIï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
npm install -g @alicloud/cli

# é…ç½® AccessKey
aliyun configure set --profile default --mode AK --region cn-hangzhou --access-key-id LTAI5tFDDZiMKb29RrdPSU3h --access-key-secret Q0TbTjlio3msQKMDqcTPTQNTOE2oac

# è·å– kubeconfigï¼ˆæ›¿æ¢ YOUR_CLUSTER_IDï¼‰
aliyun cs GET /k8s/YOUR_CLUSTER_ID/user_config | Out-File -Encoding utf8 kubeconfig.yaml
```

### æ­¥éª¤ 3: é…ç½® kubectl

```powershell
$env:KUBECONFIG = "kubeconfig.yaml"
kubectl get nodes  # æµ‹è¯•è¿æ¥
```

### æ­¥éª¤ 4: éƒ¨ç½²åº”ç”¨

```powershell
# åº”ç”¨éƒ¨ç½²é…ç½®
kubectl apply -f ack-deployment.yaml

# æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
kubectl get pods -n default
kubectl get svc -n default
```

### æ­¥éª¤ 5: è·å–è®¿é—®åœ°å€

```powershell
# æŸ¥çœ‹æœåŠ¡å¤–éƒ¨ IP
kubectl get svc algorithm-games-service -n default

# æˆ–è€…ä½¿ç”¨ JSON æ ¼å¼è·å– IP
kubectl get svc algorithm-games-service -n default -o json | ConvertFrom-Json | Select-Object -ExpandProperty status | Select-Object -ExpandProperty loadBalancer | Select-Object -ExpandProperty ingress
```

### æ­¥éª¤ 6: è®¿é—®åº”ç”¨

ç­‰å¾… LoadBalancer åˆ†é…å¤–éƒ¨ IP åï¼ˆé€šå¸¸éœ€è¦ 1-2 åˆ†é’Ÿï¼‰ï¼Œè®¿é—®ï¼š
```
http://ä½ çš„å¤–éƒ¨IP
```

## ğŸ”„ è‡ªåŠ¨åŒ–è„šæœ¬

è¿è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼š

```powershell
.\deploy-and-get-url.ps1
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. æ£€æŸ¥ kubectl å’Œ kubeconfig
2. åº”ç”¨éƒ¨ç½²é…ç½®
3. ç­‰å¾… Pod å¯åŠ¨
4. è·å–å¹¶æ˜¾ç¤ºå¤–éƒ¨è®¿é—®åœ°å€

## ğŸ“ å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] ACR å‘½åç©ºé—´å·²åˆ›å»º
- [ ] é•œåƒå·²æ„å»ºå¹¶æ¨é€
- [ ] ACK é›†ç¾¤å·²åˆ›å»º
- [ ] kubectl å·²å®‰è£…
- [ ] kubeconfig å·²é…ç½®
- [ ] éƒ¨ç½²é…ç½®å·²åº”ç”¨
- [ ] æœåŠ¡å¤–éƒ¨ IP å·²è·å–

## ğŸ†˜ æ•…éšœæ’æŸ¥

### é•œåƒæ‹‰å–å¤±è´¥
```powershell
kubectl describe pod -n default -l app=algorithm-games
kubectl logs -n default -l app=algorithm-games
```

### æœåŠ¡æ²¡æœ‰å¤–éƒ¨ IP
- æ£€æŸ¥ LoadBalancer ç±»å‹æ˜¯å¦æ­£ç¡®
- ç­‰å¾… 1-2 åˆ†é’Ÿè®©é˜¿é‡Œäº‘åˆ†é… IP
- åœ¨ ACK æ§åˆ¶å°æŸ¥çœ‹æœåŠ¡çŠ¶æ€

### Pod å¯åŠ¨å¤±è´¥
```powershell
kubectl get events -n default --sort-by='.lastTimestamp'
kubectl describe pod -n default -l app=algorithm-games
```

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. kubectl ç‰ˆæœ¬ï¼š`kubectl version --client`
2. é›†ç¾¤è¿æ¥çŠ¶æ€ï¼š`kubectl get nodes`
3. Pod çŠ¶æ€ï¼š`kubectl get pods -n default`
4. æœåŠ¡çŠ¶æ€ï¼š`kubectl get svc -n default`
5. Pod æ—¥å¿—ï¼š`kubectl logs -n default -l app=algorithm-games`


