# 自动化部署状态

## ✅ 已完成

1. ✅ **自动化部署脚本已创建**：`check-and-deploy.ps1`
2. ✅ **Docker 安装已启动**（需要等待完成）
3. ✅ **部署配置文件已准备**：`ack-deployment.yaml`

## ⏳ 当前状态

- **Docker**：正在安装中（需要等待完成并重启终端）
- **ACR 仓库**：已创建（`algorithm-games`）
- **部署脚本**：已就绪

## 🚀 自动化部署流程

一旦 Docker 安装完成，运行以下命令即可**全自动完成**所有步骤：

```powershell
.\check-and-deploy.ps1
```

脚本会自动完成：
1. ✅ 检查 Docker 状态
2. ✅ 登录 ACR
3. ✅ 构建 Docker 镜像
4. ✅ 推送镜像到 ACR
5. ✅ 更新部署配置
6. ✅ 部署到 ACK（如果 kubeconfig 已配置）
7. ✅ 获取并显示访问地址

## 📋 执行步骤

### 步骤 1: 等待 Docker 安装完成

Docker 安装可能需要几分钟。安装完成后：
- 启动 Docker Desktop
- **重启 PowerShell 终端**（重要！）

### 步骤 2: 运行自动化脚本

在新终端中运行：

```powershell
cd C:\Users\think\Documents\GitHub\dfs-mazesolver
.\check-and-deploy.ps1
```

### 步骤 3: 如果脚本提示需要 ACR 登录

如果 AccessKey 登录失败，脚本会提示手动登录：

```powershell
docker login --username=你的阿里云账号邮箱 crpi-yvms4cndr4xq7550.cn-hangzhou.personal.cr.aliyuncs.com
```

输入你的 ACR 服务密码（不是 AccessKey），然后重新运行脚本。

### 步骤 4: 如果提示需要 kubeconfig

如果脚本提示找不到 kubeconfig：

1. 登录 ACK 控制台：https://cs.console.aliyun.com
2. 选择集群 → **连接信息**
3. 复制 kubeconfig，保存为 `kubeconfig.yaml`
4. 重新运行脚本

## 🎯 预期结果

脚本成功运行后，会显示：

```
========================================
  Deployment Complete!
========================================

  Access URL: http://你的外部IP
```

## 📝 注意事项

1. **Docker 必须运行**：确保 Docker Desktop 已启动
2. **需要重启终端**：Docker 安装后需要新终端才能使用
3. **ACR 登录**：可能需要使用账号密码而不是 AccessKey
4. **kubeconfig**：如果还没有，需要从 ACK 控制台获取

## 🆘 如果遇到问题

### Docker 相关问题
- 检查 Docker Desktop 是否运行
- 重启 PowerShell 终端
- 运行 `docker info` 测试 Docker 状态

### ACR 登录问题
- 使用完整的阿里云账号邮箱作为用户名
- 使用 ACR 服务密码（不是 AccessKey）
- 如果忘记密码，在 ACR 控制台的"访问凭证"中重置

### 部署问题
- 确保镜像已成功构建和推送
- 检查 kubeconfig 是否正确
- 查看 Pod 日志：`kubectl logs -n default -l app=algorithm-games`

---

**脚本已就绪，等待 Docker 安装完成后即可全自动部署！**


